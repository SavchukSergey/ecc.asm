include '../src/math/bigint/div_rem/bi_div_rem_512_128.inc'

__bi_div_rem_512_128_test:
virtual at rsp
.locals_start:
  .dividend_hex rq 1
  .divisor_hex rq 1
  .expected_quotient_hex rq 1
  .expected_remainder_hex rq 1
  .dividend rb __BIG_INTEGER_BYTES_512
  .divisor rb __BIG_INTEGER_BYTES_512
  .quotient rb __BIG_INTEGER_BYTES_512
  .remainder rb __BIG_INTEGER_BYTES_512
.locals_end:
end virtual
        enter   .locals_end - .locals_start, 0

        mov     rbx, __bi_div_rem_512_128_test_cases
.loop:        
        lea     rcx, [rbx]
        lea     rdx, [rbx + 128]
        lea     r8, [rbx + 256]
        lea     r9, [rbx + 384]

        push    rbx
        
        mov     [.dividend_hex], rcx
        mov     [.divisor_hex], rdx
        mov     [.expected_quotient_hex], r8
        mov     [.expected_remainder_hex], r9

        mov     rcx, [.dividend_hex]
        lea     rdx, [.dividend]
        call    bi_try_read_hex_512

        mov     rcx, [.divisor_hex]
        lea     rdx, [.divisor]
        call    bi_try_read_hex_512

        lea     rcx, [.dividend]
        lea     rdx, [.divisor + 0]
        lea     r8, [.quotient]
        lea     r9, [.remainder]
        call    test_context_start_measure
        call    bi_div_rem_512_128
        call    test_context_end_measure

        mov     rcx, [.expected_quotient_hex]
        lea     rdx, [.quotient]
        call    bi_assert_equal_hex_512

        mov     rcx, [.expected_remainder_hex]
        lea     rdx, [.remainder]
        call    bi_assert_equal_hex_512

        pop     rbx
        add     rbx, 512
        cmp     rbx, __bi_div_rem_512_128_test_cases.end
        jb      .loop

        leave
        ret

__bi_div_rem_512_128_test_cases:
;64-bit divisor
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'

  db 'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001'
  db 'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001'
  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003'
  db '3E160C0553ABD508C421857332C2000644A750F781E8FCC7D9DA3D0966FDBBA80826E911CEAC56282CF0278BE803E46F2B0B6D5F0E7DE606751680A2BB78314D'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006'
  db '1F0B0602A9D5EA846210C2B9996100032253A87BC0F47E63ECED1E84B37EDDD404137488E7562B14167813C5F401F2379585B6AF873EF3033A8B40515DBC18A6'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e'
  db '01B1795894E66E898C54B22F5C25DF6B39BA172754FF5F5493E7B28990C5C1A0828CB2931A94FDB1F7EA9F554529FF3F8A7BA8381EA657BA5BA1320DBF4B6C66'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000014'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed'
  db '0000000000000001b08dc414ec2f90b595de024853a381f430fa033dbe5f7fb0641adad5a13a4323bd35c4551321899e8766b13176aa5189b3b47a1c36c93b43'
  db '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005a40c05f8c5dbe1'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff'
  db '0000000000000000ba42240ffb037f1b06a6b46993497f2dd49ca75019047585622b5e6c4dfda87d7aa019a1ba02aaf601709045720e58438292d8629d880a56'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e1d65a4acff09e3e'

;128-bit divisor
  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed8'
  db '00000000000000001b08dc414ec2f90b39f99b842bdd3ef7d86077c69dbf8e7dd3b8a393e7569746decfd8cd4e11f432ae5908c1d3202114ff57cc4ed5e1cbc2'
  db '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150ab337d2612ec38'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed81'
  db '000000000000000001b08dc414ec2f90b39bad2faeb2a850589d49225a39203a33e6cb0e474b8c2a980918b903585000a78a0b844b3665ebe7c6ba76f8414973'
  db '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003163c55b95b9f819f5'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed812'
  db '0000000000000000001B08DC414EC2F90B39B2F9E9C3142DC7400329F273E438A1C5EB395D40058248E76FCEE55DD86838CC11F3C96B01B9DFFD3B7418E47511'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000283C6384806E71400B6'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed8124'
  db '00000000000000000001B08DC414EC2F90B39B1FEC79E1162DF76C8FD3E11ACDEDAFE43AA86BB15C6153D6DD311D54625910DE4861A9B9487CB3648D360AFDF0'
  db '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000227A5A7A39BE87B6EE28'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed81247'
  db '000000000000000000001B08DC414EC2F90B39B1E34FE20514AE1CC6A05B71FF4AFA501B21C8BBAD3D9FCF0E373F3C7BE9E7662E06FDB166A834193885DCC1E5'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000575F872ED22BA9D54B365'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed812475'
  db '0000000000000000000001B08DC414EC2F90B39B1E215F756D1307B0B17A39E74BA711A6ACFC7018C68A2A1CF5F9CEEEEDE4F9F140F68E549EFE4C5986884B5F'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000969590DD397C69DA5C57D'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed812475b'
  db '00000000000000000000001B08DC414EC2F90B39B1E1EACD7874B59B3481A3F160B3E23748A04B4AA01E5893098D31791AB4BA4447D7D43B531C1773C9F74191'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001175D667B843C88E0230E5D'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed812475be'
  db '000000000000000000000001B08DC414EC2F90B39B1E1E75E80F32BD50941585510965EEEE51CF3CF07E2A79FDD92A14913095BFF822ED98E8D640E4E5902439'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001353AAC0F04C6D01FDBA49A'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed812475be9'
  db '0000000000000000000000001B08DC414EC2F90B39B1E1E73B3025F77080A90C26C8CC0F7777A1B3E2DDF194023CF2ADBD97407B0030EC8BAFDFA757716685F9'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000497F0FABF5A05BD0FE06A2147'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed812475be9b'
  db '00000000000000000000000001B08DC414EC2F90B39B1E1E7387D8811A8D2ABA2C6CDFAD413EA582B4CBF878CDC140FEE00E07DAED5F2B1DAF3FDD58C56446D1'
  db '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000191F59B02C250C1D8D809D955D'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed812475be9b5'
  db '000000000000000000000000001B08DC414EC2F90B39B1E1E73869E966C49AD1870E427D9C928CB527D60F1377AECC6A01CA360E3163271F1924718D631048A0'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000057EBC369529523DB39924EB9AC8'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed812475be9b51'
  db '0000000000000000000000000001B08DC414EC2F90B39B1E1E73869AA9E3B5A1ECD1BF3F2724755234C537B27CA81FFF8640256C81327DC9DD5E7551CE0F411B'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C66362570854A8130631A1FA15D'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed812475be9b51c'
  db '00000000000000000000000000001B08DC414EC2F90B39B1E1E738697B87D46998C1A6390A128EEB75E870EA48925BAD41F89460AD1571EC831F23F9ED0D02B6'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004034E4C1A390C2752F0AFE86B9A00'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed812475be9b51c3'
  db '000000000000000000000000000001B08DC414EC2F90B39B1E1E738697ACB7ACDD6A978621E711009CF32E2AD344ADF732B37F113844C556689C5B2012C96B5F'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000132518B231F9D145F1A678A37DBB8B'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed812475be9b51c3c'
  db '0000000000000000000000000000001B08DC414EC2F90B39B1E1E738697A9C6466E6236CEC6388B05165857F1F894BB842A48CD360BD68608CD288E183BD7509'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002CF1ACCDA36A7481C2914F8A8D729CC'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed812475be9b51c3cf'
  db '00000000000000000000000000000001B08DC414EC2F90B39B1E1E738697A98B6A6DB58F40730EE88D6FD43F3587ED839EBC7633ACEC214D32EA5C2BF289A7D9'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001FE5A4331E52789D0A67AA63BB969071'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffff'
  db '00000000000000000000000000000000ba42240ffb037f1a4c64905998460013883816f680be7571d9f34775cd3f330ba0acd22becc377ea60c3be19854ae059'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000021cf1a49183d29fdc0074001b7b37441'

  .end:

