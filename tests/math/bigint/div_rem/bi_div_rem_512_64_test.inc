include '../src/math/bigint/div_rem/bi_div_rem_512_64.inc'

__bi_div_rem_512_64_test:
virtual at rsp
.locals_start:
  .dividend_hex rq 1
  .divisor_hex rq 1
  .expected_quotient_hex rq 1
  .expected_remainder_hex rq 1
  .dividend rb __BIG_INTEGER_BYTES_512
  .divisor rb __BIG_INTEGER_BYTES_512
  .quotient rb __BIG_INTEGER_BYTES_512
  .remainder rb __BIG_INTEGER_BYTES_512
.locals_end:
end virtual
        enter   .locals_end - .locals_start, 0

        mov     rbx, __bi_div_rem_512_64_test_cases
.loop:        
        lea     rcx, [rbx]
        lea     rdx, [rbx + 128]
        lea     r8, [rbx + 256]
        lea     r9, [rbx + 384]

        push    rbx
        
        mov     [.dividend_hex], rcx
        mov     [.divisor_hex], rdx
        mov     [.expected_quotient_hex], r8
        mov     [.expected_remainder_hex], r9

        mov     rcx, [.dividend_hex]
        lea     rdx, [.dividend]
        call    bi_try_read_hex_512

        mov     rcx, [.divisor_hex]
        lea     rdx, [.divisor]
        call    bi_try_read_hex_512

        lea     rcx, [.dividend]
        mov     rdx, qword [.divisor + 0]
        lea     r8, [.quotient]
        lea     r9, [.remainder]
        call    test_context_start_measure
        call    bi_div_rem_512_64
        call    test_context_end_measure

        mov     rcx, [.expected_quotient_hex]
        lea     rdx, [.quotient]
        call    bi_assert_equal_hex_512

        mov     rcx, [.expected_remainder_hex]
        lea     rdx, [.remainder]
        call    bi_assert_equal_hex_512

        pop     rbx
        add     rbx, 512
        cmp     rbx, __bi_div_rem_512_64_test_cases.end
        jb      .loop

        leave
        ret

__bi_div_rem_512_64_test_cases:
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'

  db 'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001'
  db 'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001'
  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003'
  db '3E160C0553ABD508C421857332C2000644A750F781E8FCC7D9DA3D0966FDBBA80826E911CEAC56282CF0278BE803E46F2B0B6D5F0E7DE606751680A2BB78314D'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006'
  db '1F0B0602A9D5EA846210C2B9996100032253A87BC0F47E63ECED1E84B37EDDD404137488E7562B14167813C5F401F2379585B6AF873EF3033A8B40515DBC18A6'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e'
  db '01B1795894E66E898C54B22F5C25DF6B39BA172754FF5F5493E7B28990C5C1A0828CB2931A94FDB1F7EA9F554529FF3F8A7BA8381EA657BA5BA1320DBF4B6C66'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000014'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e3be8abd2e089ed'
  db '0000000000000001b08dc414ec2f90b595de024853a381f430fa033dbe5f7fb0641adad5a13a4323bd35c4551321899e8766b13176aa5189b3b47a1c36c93b43'
  db '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005a40c05f8c5dbe1'

  db 'ba42240ffb037f1a4c64905998460012cdf5f2e685baf6578d8eb71c34f932f81874bb356c05027886d076a3b80bad4d8122481d2b79b2135f4381e8326893e8'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff'
  db '0000000000000000ba42240ffb037f1b06a6b46993497f2dd49ca75019047585622b5e6c4dfda87d7aa019a1ba02aaf601709045720e58438292d8629d880a56'
  db '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e1d65a4acff09e3e'

  .end:

